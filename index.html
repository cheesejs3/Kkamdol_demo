<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, black-translucent">
    <link href="https://cdn.jsdelivr.net/gh/sun-typeface/SUIT@2/fonts/variable/woff2/SUIT-Variable.css" rel="stylesheet">
    <title></title>
    <style>
        *{margin: 0;
        font-family: 'SUIT Variable', sans-serif;}

        body{ width:100vw;
            height: 100vh;
            background-image: linear-gradient(-2deg, #a29990 -20%, #dfd9d8 30%);
            background-attachment: fixed;}

         #calendar-grid {
            display: grid;
            /* í•œ ì¤„ì— 7ê°œì˜ ë™ì¼í•œ í¬ê¸° ì—´ ìƒì„± */
            grid-template-columns: repeat(7, 1fr); 
            gap: 5px; /* ì¹¸ ê°„ê²© */
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            padding-top: calc(env(safe-area-inset-top) + 30px + 3em);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        #year-grid{
            box-sizing: border-box;
            position: fixed;
            z-index: 100;
            display: grid;
            grid-template-columns: repeat(5, 1fr); 
            max-width: 800px;
            width: 100%;
            padding-top: calc(env(safe-area-inset-top) + 10px );
            padding-left:10px;
            padding-right: 10px;
            font-weight: 400;
            font-size:1em;
            letter-spacing: -0.018em;
            top: 30px;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        #year-grid > div {
            padding:10px 15px;
            margin: 0 auto;
            align-items: center;
            justify-content: center;
            border-radius: 30rem;
            background-color: rgba(244, 244, 244, 0.5);
            box-shadow: inset 0 0 0.3rem rgba(244, 244, 244, 0.8);
            backdrop-filter: blur(3px);
        }

        .calendar-cell {
            overflow: hidden;
            /* ë‚ ì§œ ì¹¸ì˜ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
            aspect-ratio: 1/1;
            border: 1px solid #ddd;
            border-radius: 20%;
            display: flex; 
            flex-direction: column;
            align-items: center;
            justify-content: center; 
            padding: 5px;
            box-sizing: border-box;
            font-size: 14px;
            position: relative;
            
        }
        
        .date-number {
            font-weight: bold;
            font-size: 1.2em;
        }

        .empty-cell {
            background-color: transparent; 
            border: none;
        }


        .year-color-0 { } /* ì—°í•œ í•˜ëŠ˜ìƒ‰ */
        .year-color-1 { background-color: #fce4ec; } /* ì—°í•œ ë¶„í™ìƒ‰ */
        .year-color-2 { background-color: #fffde7; } /* ì—°í•œ ë…¸ë€ìƒ‰ */
        .year-color-3 { background-color: #e8f5e9; } /* ì—°í•œ ë…¹ìƒ‰ */
        .year-color-4 { background-color: #ede7f6; } /* ì—°í•œ ë³´ë¼ìƒ‰ */
        
        /* ì›”ë³„ êµ¬ë¶„ì: ì¼ë°˜ ì…€ê³¼ ë™ì¼í•œ í¬ê¸° ìœ ì§€ */
        .month-separator {
            /* âœ¨ ì›” êµ¬ë¶„ì: 1ì¹¸ë§Œ ì°¨ì§€í•˜ë©°, ì—°ì†ëœ íë¦„ì— ì‚½ì…ë©ë‹ˆë‹¤. */
            /* grid-column: 1 / span 7; ì†ì„±ì„ ì œê±°í•˜ì—¬ 1ì¹¸ë§Œ ì°¨ì§€í•˜ë„ë¡ í•©ë‹ˆë‹¤. */
            box-shadow: inset 0 0 0.3rem rgba(244, 244, 244, 0.8);
            
            background-color: unset;
            color: white;
            font-size: 1.74em;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .date-day-link {
            text-decoration: none;
            color: inherit;
        }
    
    </style>
</head>
<body>
    <div id="year-grid">
        <div id="btn2021">2021</div>
        <div id="btn2022">2022</div>
        <div id="btn2023">2023</div>
        <div id="btn2024">2024</div>
        <div id="btn2025">2025</div>
    </div>
    <div id="calendar-grid">
    </div>

<script>
    // ----------------------------------------------------
    // 1. ë°ì´í„° ìƒì„± í•¨ìˆ˜ (ì›” ê°„ê²© ë¹ˆ ì¹¸ ì±„ìš°ê¸° ë¡œì§ ì œê±°)
    // ----------------------------------------------------
    function generateContiguousCalendarItems(startDateStr, endDateStr) {
        const startDate = new Date(startDateStr);
        const endDate = new Date(endDateStr);
        const calendarItems = [];
        
        let currentDate = new Date(startDate);
        let currentMonth = startDate.getMonth();
        let currentYear = startDate.getFullYear();

        const startYear = startDate.getFullYear();
        
        // 1. ì‹œì‘ ì›”ì˜ ì›”ë³„ êµ¬ë¶„ì ì¶”ê°€ (4ì›”)
        calendarItems.push({ 
            type: 'month', 
            value: `${currentMonth + 1}`,
            year: currentYear,
            colorIndex: (currentYear - startYear) % 5
        });

        while (currentDate <= endDate) {
            const date = currentDate.getDate();
            const month = currentDate.getMonth();
            const year = currentDate.getFullYear();
            
            const colorIndex = (year - startYear) % 5; 
            
            // 2. ì›”ì´ ë°”ë€Œë©´ (1ì¼ì´ ë˜ë©´) ì›”ë³„ êµ¬ë¶„ì ì¶”ê°€
            if (date === 1 && (month !== currentMonth || year !== currentYear)) {
                
                // ğŸ”¥ğŸ”¥ğŸ”¥ í•µì‹¬ ìˆ˜ì •: ì›”ì´ ë°”ë€” ë•Œ, ì´ì „ ì›”ì˜ ë§ˆì§€ë§‰ ì£¼ê°€ 7ì—´ì„ ì±„ìš°ë„ë¡ ë¹ˆ ì…€ ì¶”ê°€ ë¡œì§ì„ ì œê±°í•¨
                
                calendarItems.push({ 
                    type: 'month', 
                    value: `${month + 1}`,
                    year: year,
                    colorIndex: colorIndex
                });
                
                currentMonth = month;
                currentYear = year;
            }

            // 3. ë‚ ì§œ ì…€ ì¶”ê°€
            calendarItems.push({
                type: 'day',
                value: date,
                fullDate: currentDate.toISOString().split('T')[0],
                year: year,
                colorIndex: colorIndex
            });

            currentDate.setDate(currentDate.getDate() + 1);
        }
        
        // 4. ë§ˆì§€ë§‰ ë‚ ì§œ ì´í›„ ë‚¨ì€ ë¹ˆì¹¸ ì±„ìš°ê¸° (ìµœì¢… ê·¸ë¦¬ë“œ ì™„ì„±ë„ë¥¼ ìœ„í•´ ìœ ì§€)
        while (calendarItems.length % 7 !== 0) {
             calendarItems.push({ type: 'empty' });
        }
        
        return calendarItems;
    }

    // ----------------------------------------------------
    // 2. ì¸ë„¤ì¼ ì¡´ì¬ ì—¬ë¶€ ì²´í¬ ë° ë°ì´í„° í™•ì¥ í•¨ìˆ˜ (ìœ ì§€)
    // ----------------------------------------------------
    function fetchDayData(item) {
        if (item.type !== 'day') {
            return Promise.resolve(item);
        }
        
        const thumbnailPath = `thumb/${item.fullDate}.webp`; 
        
        return fetch(thumbnailPath, { method: 'HEAD' })
            .then(response => {
                if (response.ok) {
                    return { ...item, hasThumbnail: true, thumbnailPath: thumbnailPath };
                } else {
                    return { ...item, hasThumbnail: false };
                }
            })
            .catch(error => {
                console.error(`ì¸ë„¤ì¼ ì¡´ì¬ í™•ì¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ (${thumbnailPath}):`, error);
                return { ...item, hasThumbnail: false };
            });
    }

    // ----------------------------------------------------
    // 3. ëª¨ë“  ë°ì´í„°ë¥¼ ì¤€ë¹„í•˜ê³  ë Œë”ë§ì„ ì‹œì‘í•˜ëŠ” ë¹„ë™ê¸° ë©”ì¸ í•¨ìˆ˜ (ìœ ì§€)
    // ----------------------------------------------------
    async function prepareAndRenderCalendar() {
        // ë‚ ì§œ ë²”ìœ„ëŠ” ì‚¬ìš©ìì˜ ì‹¤ì œ ë°ì´í„°ì— ë§ê²Œ ì¡°ì •í•˜ì„¸ìš”.
        const START_DATE = '2021-04-25'; 
        const END_DATE = '2021-09-08';
        const calendarData = generateContiguousCalendarItems(START_DATE, END_DATE);
        
        const preparedDataPromises = calendarData.map(fetchDayData);
        const finalCalendarData = await Promise.all(preparedDataPromises);
        
        renderCalendarGrid(finalCalendarData);
        setupScrollButtons();
    }


    // ----------------------------------------------------
    // 4. ìµœì¢… ë Œë”ë§ í•¨ìˆ˜ (ë™ê¸°) (ìœ ì§€)
    // ----------------------------------------------------
    function renderCalendarGrid(calendarData) {
        const TARGET_PAGE_URL = 'specific.html';
        const gridContainer = document.getElementById('calendar-grid');
        
        gridContainer.innerHTML = '';
        
        calendarData.forEach(item => {
            const cell = document.createElement('div');
            cell.className = 'calendar-cell'; 
            
            if (item.type !== 'empty') {
                cell.className += ` year-color-${item.colorIndex}`;
            }

            if (item.type === 'month') {
                cell.className += ' month-separator'; 
                cell.textContent = item.value;
                
                gridContainer.appendChild(cell);
                
            } else if (item.type === 'empty') {
                cell.className += ' empty-cell';
                gridContainer.appendChild(cell);
                
            } else if (item.type === 'day') { 
                
                
                let elementToAppend = cell;

                if (item.hasThumbnail) { 
                    
                    const img = document.createElement('img');
                    img.src = item.thumbnailPath; 
                    img.alt = `${item.fullDate} ì¸ë„¤ì¼`;
                    img.style.width = '100%';
                    img.style.height = '100%';
                    img.style.objectFit = 'cover'; 
                    img.style.position = 'absolute';
                    img.style.top = '0';
                    img.style.left = '0';
                    img.style.zIndex = '1';
                    cell.appendChild(img);
                    
                    const link = document.createElement('a');
                    link.href = `${TARGET_PAGE_URL}?date=${item.fullDate}`; 
                    link.className = 'date-day-link'; 
                    link.appendChild(cell);
                    
                    elementToAppend = link; 

                } else {
                }
                
                gridContainer.appendChild(elementToAppend);
            }
        });
    }

    // ----------------------------------------------------
    // 5. ìŠ¤í¬ë¡¤ ë²„íŠ¼ í†µí•© ì„¤ì • í•¨ìˆ˜ (ìœ ì§€)
    // ----------------------------------------------------
    function setupScrollButtons() {
        function remToPx(rem) {
            return rem * parseFloat(getComputedStyle(document.documentElement).fontSize);
        }
        
        const offsetPx = remToPx(4); 
        
        const yearButtons = [
            { id: 'btn2021', colorIndex: 0 },
            { id: 'btn2022', colorIndex: 1 },
            { id: 'btn2023', colorIndex: 2 },
            { id: 'btn2024', colorIndex: 3 },
            { id: 'btn2025', colorIndex: 4 }
        ];

        yearButtons.forEach(btn => {
            const buttonElement = document.getElementById(btn.id);
            const targetClass = `.year-color-${btn.colorIndex}`;

            if (buttonElement) {
                buttonElement.addEventListener('click', () => {
                    const targetDiv = document.querySelector(targetClass + '.date-day'); 

                    if (targetDiv) {
                        const targetRect = targetDiv.getBoundingClientRect(); 
                        const absoluteTop = targetRect.top + window.scrollY;
                        const scrollToPosition = absoluteTop - offsetPx;
                        
                        window.scrollTo({
                            top: scrollToPosition,
                            behavior: 'smooth' 
                        });
                    }
                });
            }
        });
    }

    // ----------------------------------------------------
    // 6. DOMContentLoaded ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ (ìœ ì§€)
    // ----------------------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
        const gridContainer = document.getElementById('calendar-grid');
        gridContainer.innerHTML = `<div style="grid-column: 1 / span 7; text-align: center; padding-top: 50px;">ë°ì´í„° ë¡œë”© ì¤‘...</div>`;
        
        prepareAndRenderCalendar().catch(error => {
            console.error("ìº˜ë¦°ë” ë Œë”ë§ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
            gridContainer.innerHTML = `<div style="grid-column: 1 / span 7; text-align: center; padding-top: 50px; color: red;">ìº˜ë¦°ë” ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ</div>`;
        });
    });
</script>
</body>
</html>
